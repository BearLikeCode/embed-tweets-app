{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.TimelineV2Paginator = exports.TwitterV2Paginator = void 0;\n\nconst includes_v2_helper_1 = require(\"../v2/includes.v2.helper\");\n\nconst TwitterPaginator_1 = require(\"./TwitterPaginator\");\n/** A generic PreviousableTwitterPaginator with common v2 helper methods. */\n\n\nclass TwitterV2Paginator extends TwitterPaginator_1.PreviousableTwitterPaginator {\n  updateIncludes(data) {\n    // Update errors\n    if (data.errors) {\n      if (!this._realData.errors) {\n        this._realData.errors = [];\n      }\n\n      this._realData.errors = [...this._realData.errors, ...data.errors];\n    } // Update includes\n\n\n    if (!data.includes) {\n      return;\n    }\n\n    if (!this._realData.includes) {\n      this._realData.includes = {};\n    }\n\n    const includesRealData = this._realData.includes;\n\n    for (const [includeKey, includeArray] of Object.entries(data.includes)) {\n      if (!includesRealData[includeKey]) {\n        includesRealData[includeKey] = [];\n      }\n\n      includesRealData[includeKey] = [...includesRealData[includeKey], ...includeArray];\n    }\n  }\n  /** Throw if the current paginator is not usable. */\n\n\n  assertUsable() {\n    if (this.unusable) {\n      throw new Error('Unable to use this paginator to fetch more data, as it does not contain any metadata.' + ' Check .errors property for more details.');\n    }\n  }\n\n  get meta() {\n    return this._realData.meta;\n  }\n\n  get includes() {\n    var _a;\n\n    if (!((_a = this._realData) === null || _a === void 0 ? void 0 : _a.includes)) {\n      return new includes_v2_helper_1.TwitterV2IncludesHelper(this._realData);\n    }\n\n    if (this._includesInstance) {\n      return this._includesInstance;\n    }\n\n    return this._includesInstance = new includes_v2_helper_1.TwitterV2IncludesHelper(this._realData);\n  }\n\n  get errors() {\n    var _a;\n\n    return (_a = this._realData.errors) !== null && _a !== void 0 ? _a : [];\n  }\n  /** `true` if this paginator only contains error payload and no metadata found to consume data. */\n\n\n  get unusable() {\n    return this.errors.length > 0 && !this._realData.meta && !this._realData.data;\n  }\n\n}\n\nexports.TwitterV2Paginator = TwitterV2Paginator;\n/** A generic TwitterV2Paginator able to consume v2 timelines that use max_results and pagination tokens. */\n\nclass TimelineV2Paginator extends TwitterV2Paginator {\n  refreshInstanceFromResult(response, isNextPage) {\n    var _a;\n\n    const result = response.data;\n    const resultData = (_a = result.data) !== null && _a !== void 0 ? _a : [];\n    this._rateLimit = response.rateLimit;\n\n    if (!this._realData.data) {\n      this._realData.data = [];\n    }\n\n    if (isNextPage) {\n      this._realData.meta.result_count += result.meta.result_count;\n      this._realData.meta.next_token = result.meta.next_token;\n\n      this._realData.data.push(...resultData);\n    } else {\n      this._realData.meta.result_count += result.meta.result_count;\n      this._realData.meta.previous_token = result.meta.previous_token;\n\n      this._realData.data.unshift(...resultData);\n    }\n\n    this.updateIncludes(result);\n  }\n\n  getNextQueryParams(maxResults) {\n    this.assertUsable();\n    return { ...this.injectQueryParams(maxResults),\n      pagination_token: this._realData.meta.next_token\n    };\n  }\n\n  getPreviousQueryParams(maxResults) {\n    this.assertUsable();\n    return { ...this.injectQueryParams(maxResults),\n      pagination_token: this._realData.meta.previous_token\n    };\n  }\n\n  getPageLengthFromRequest(result) {\n    var _a, _b;\n\n    return (_b = (_a = result.data.data) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0;\n  }\n\n  isFetchLastOver(result) {\n    var _a;\n\n    return !((_a = result.data.data) === null || _a === void 0 ? void 0 : _a.length) || !this.canFetchNextPage(result.data);\n  }\n\n  canFetchNextPage(result) {\n    var _a;\n\n    return !!((_a = result.meta) === null || _a === void 0 ? void 0 : _a.next_token);\n  }\n\n}\n\nexports.TimelineV2Paginator = TimelineV2Paginator;","map":{"version":3,"names":["Object","defineProperty","exports","value","TimelineV2Paginator","TwitterV2Paginator","includes_v2_helper_1","require","TwitterPaginator_1","PreviousableTwitterPaginator","updateIncludes","data","errors","_realData","includes","includesRealData","includeKey","includeArray","entries","assertUsable","unusable","Error","meta","_a","TwitterV2IncludesHelper","_includesInstance","length","refreshInstanceFromResult","response","isNextPage","result","resultData","_rateLimit","rateLimit","result_count","next_token","push","previous_token","unshift","getNextQueryParams","maxResults","injectQueryParams","pagination_token","getPreviousQueryParams","getPageLengthFromRequest","_b","isFetchLastOver","canFetchNextPage"],"sources":["/Users/user/Sites/twits_app/twits/node_modules/twitter-api-v2/dist/paginators/v2.paginator.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TimelineV2Paginator = exports.TwitterV2Paginator = void 0;\nconst includes_v2_helper_1 = require(\"../v2/includes.v2.helper\");\nconst TwitterPaginator_1 = require(\"./TwitterPaginator\");\n/** A generic PreviousableTwitterPaginator with common v2 helper methods. */\nclass TwitterV2Paginator extends TwitterPaginator_1.PreviousableTwitterPaginator {\n    updateIncludes(data) {\n        // Update errors\n        if (data.errors) {\n            if (!this._realData.errors) {\n                this._realData.errors = [];\n            }\n            this._realData.errors = [...this._realData.errors, ...data.errors];\n        }\n        // Update includes\n        if (!data.includes) {\n            return;\n        }\n        if (!this._realData.includes) {\n            this._realData.includes = {};\n        }\n        const includesRealData = this._realData.includes;\n        for (const [includeKey, includeArray] of Object.entries(data.includes)) {\n            if (!includesRealData[includeKey]) {\n                includesRealData[includeKey] = [];\n            }\n            includesRealData[includeKey] = [\n                ...includesRealData[includeKey],\n                ...includeArray,\n            ];\n        }\n    }\n    /** Throw if the current paginator is not usable. */\n    assertUsable() {\n        if (this.unusable) {\n            throw new Error('Unable to use this paginator to fetch more data, as it does not contain any metadata.' +\n                ' Check .errors property for more details.');\n        }\n    }\n    get meta() {\n        return this._realData.meta;\n    }\n    get includes() {\n        var _a;\n        if (!((_a = this._realData) === null || _a === void 0 ? void 0 : _a.includes)) {\n            return new includes_v2_helper_1.TwitterV2IncludesHelper(this._realData);\n        }\n        if (this._includesInstance) {\n            return this._includesInstance;\n        }\n        return this._includesInstance = new includes_v2_helper_1.TwitterV2IncludesHelper(this._realData);\n    }\n    get errors() {\n        var _a;\n        return (_a = this._realData.errors) !== null && _a !== void 0 ? _a : [];\n    }\n    /** `true` if this paginator only contains error payload and no metadata found to consume data. */\n    get unusable() {\n        return this.errors.length > 0 && !this._realData.meta && !this._realData.data;\n    }\n}\nexports.TwitterV2Paginator = TwitterV2Paginator;\n/** A generic TwitterV2Paginator able to consume v2 timelines that use max_results and pagination tokens. */\nclass TimelineV2Paginator extends TwitterV2Paginator {\n    refreshInstanceFromResult(response, isNextPage) {\n        var _a;\n        const result = response.data;\n        const resultData = (_a = result.data) !== null && _a !== void 0 ? _a : [];\n        this._rateLimit = response.rateLimit;\n        if (!this._realData.data) {\n            this._realData.data = [];\n        }\n        if (isNextPage) {\n            this._realData.meta.result_count += result.meta.result_count;\n            this._realData.meta.next_token = result.meta.next_token;\n            this._realData.data.push(...resultData);\n        }\n        else {\n            this._realData.meta.result_count += result.meta.result_count;\n            this._realData.meta.previous_token = result.meta.previous_token;\n            this._realData.data.unshift(...resultData);\n        }\n        this.updateIncludes(result);\n    }\n    getNextQueryParams(maxResults) {\n        this.assertUsable();\n        return {\n            ...this.injectQueryParams(maxResults),\n            pagination_token: this._realData.meta.next_token,\n        };\n    }\n    getPreviousQueryParams(maxResults) {\n        this.assertUsable();\n        return {\n            ...this.injectQueryParams(maxResults),\n            pagination_token: this._realData.meta.previous_token,\n        };\n    }\n    getPageLengthFromRequest(result) {\n        var _a, _b;\n        return (_b = (_a = result.data.data) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0;\n    }\n    isFetchLastOver(result) {\n        var _a;\n        return !((_a = result.data.data) === null || _a === void 0 ? void 0 : _a.length) || !this.canFetchNextPage(result.data);\n    }\n    canFetchNextPage(result) {\n        var _a;\n        return !!((_a = result.meta) === null || _a === void 0 ? void 0 : _a.next_token);\n    }\n}\nexports.TimelineV2Paginator = TimelineV2Paginator;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}